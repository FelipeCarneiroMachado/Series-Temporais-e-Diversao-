---
title: "trabalho"
output: html_document
---

# Trabalho final de Séries Temporais e Aprendizado Dinâmico

Realizado por: - Felipe Carneiro Machado - Thales Sena de Queiroz - Abuja

## Importação de pacotes

```{r}
library(tidyverse, quietly = TRUE)
library(ggplot2, quietly = TRUE)
library(broom, quietly = TRUE)
library(plotly, quietly = TRUE)
```


Serão analisadas séries temporais de criminalidade em São Paulo.

```{r}
taxa_delito_estado_sp <-  readxl::read_xlsx("../data/TaxaDelito-EstadoSP_20251020_211705.xlsx")
indicadores_seguranca_publica_uf <- readxl::read_excel("../data/indicadoressegurancapublicauf.xlsx")
```

O primeiro dataset contem o numero de ocorrencias anuais de certos tipos de crime apenas para SP. O segundo possui resolucao de meses para todos os estados brasileiros. Iremos fazer o recorte para o estado de SP.

```{r}
meses<- c('janeiro' = 1,'fevereiro' = 2,'março' = 3,'abril' = 4,'maio' =5,'junho' = 6 , 'julho'=7,'agosto'=8,'setembro'=9,'outubro'=10,'novembro'=11,'dezembro'=12)

crimes_mensal_sp_wide <- indicadores_seguranca_publica_uf |> 
  filter(UF == "São Paulo") |> 
  pivot_wider(
    names_from = c(`Tipo Crime`),
    values_from= Ocorrências
  ) |> 
  mutate(
    Mes_num = meses[str_trim(Mês)],
    Data = make_date(year = Ano, month = Mes_num)
  ) |> 
  select(
    !c(Ano, Mês, Mes_num, UF)
  ) |> 
  arrange(Data) |> 
  replace_na(list(`Lesão corporal seguida de morte` = 0))
```

Vamos plotar as series para visualizar as variacoes no tempo

```{r}
crimes_mensal_sp_wide |>
  pivot_longer(
    cols=!c(Data),
    names_to = "Tipo.crime",
    values_to = "Ocorrencia"
  ) |> 
  ggplot(aes(x = Data, y = Ocorrencia, color = `Tipo.crime`)) +
  geom_line()
```

Nota-se que furto e roubo de veiculos tem maiores valores, com sazonalidade mais aparente a primeira vista. Outros crimes tem valores mais constantes, sendo necessario visualizacao mais proxima

